<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>SiSocial</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  font-family: Arial, sans-serif;
  background:#111;
  color:#fff;
  text-align:center;
  padding:20px;
}
.box{
  background:#1e1e1e;
  padding:15px;
  border-radius:10px;
  max-width:360px;
  margin:15px auto;
}
input, textarea, button{
  width:100%;
  padding:10px;
  margin:8px 0;
  border:none;
  border-radius:6px;
}
button{
  background:#4caf50;
  color:#fff;
  font-weight:bold;
}
img{
  width:60px;
  height:60px;
  border-radius:50%;
  object-fit:cover;
}
.post{
  background:#2a2a2a;
  padding:10px;
  border-radius:8px;
  margin-top:10px;
  text-align:left;
}
.hidden{ display:none; }
.like{
  cursor:pointer;
  color:#4caf50;
  font-weight:bold;
}
</style>
</head>

<body>

<div class="box" id="cadastro">
  <h2>Criar conta</h2>
  <input id="nome" placeholder="Seu nome">
  <input id="codigo" placeholder="Código de 4 dígitos" maxlength="4" inputmode="numeric">
  <input type="file" id="foto" accept="image/*">
  <button onclick="criarConta()">Criar conta</button>
</div>

<div class="box hidden" id="login">
  <h2>Entrar</h2>
  <input id="codigoLogin" placeholder="Código de 4 dígitos" maxlength="4" inputmode="numeric">
  <button onclick="entrar()">Entrar</button>
</div>

<div class="box hidden" id="perfil">
  <img id="fotoPerfil">
  <h3 id="nomePerfil"></h3>
  <textarea id="textoPost" placeholder="O que você está pensando?"></textarea>
  <button onclick="criarPost()">Postar</button>
</div>

<div class="box hidden" id="feed">
  <h3>Feed</h3>
  <div id="posts"></div>
</div>

<script>
let usuarios = JSON.parse(localStorage.getItem("usuarios")) || [];
let posts = JSON.parse(localStorage.getItem("posts")) || [];
let usuarioLogado = null;

function criarConta(){
  const nome = nomeInput.value.trim();
  const codigo = codigoInput.value.trim();
  if(nome === "" || codigo.length !== 4) return alert("Dados inválidos");

  if(usuarios.find(u => u.codigo === codigo))
    return alert("Código já existe");

  const reader = new FileReader();
  reader.onload = () => {
    usuarios.push({ nome, codigo, foto: reader.result });
    localStorage.setItem("usuarios", JSON.stringify(usuarios));
    cadastro.classList.add("hidden");
    login.classList.remove("hidden");
  };
  foto.files[0] ? reader.readAsDataURL(foto.files[0]) : reader.onload();
}

function entrar(){
  const codigo = codigoLogin.value.trim();
  usuarioLogado = usuarios.find(u => u.codigo === codigo);
  if(!usuarioLogado) return alert("Código inválido");

  login.classList.add("hidden");
  perfil.classList.remove("hidden");
  feed.classList.remove("hidden");

  nomePerfil.innerText = usuarioLogado.nome;
  fotoPerfil.src = usuarioLogado.foto || "";

  renderFeed();
}

function criarPost(){
  if(textoPost.value.trim() === "") return;
  posts.unshift({
    autor: usuarioLogado.nome,
    foto: usuarioLogado.foto,
    texto: textoPost.value,
    likes: 0
  });
  localStorage.setItem("posts", JSON.stringify(posts));
  textoPost.value = "";
  renderFeed();
}

function curtir(index){
  posts[index].likes++;
  localStorage.setItem("posts", JSON.stringify(posts));
  renderFeed();
}

function renderFeed(){
  postsDiv.innerHTML = "";
  posts.forEach((p, i) => {
    postsDiv.innerHTML += `
      <div class="post">
        <img src="${p.foto}">
        <b>${p.autor}</b>
        <p>${p.texto}</p>
        <span class="like" onclick="curtir(${i})">❤️ ${p.likes}</span>
      </div>
    `;
  });
}

const nomeInput = document.getElementById("nome");
const codigoInput = document.getElementById("codigo");
const foto = document.getElementById("foto");
const cadastro = document.getElementById("cadastro");
const login = document.getElementById("login");
const perfil = document.getElementById("perfil");
const feed = document.getElementById("feed");
const postsDiv = document.getElementById("posts");
const textoPost = document.getElementById("textoPost");
</script>

</body>
</html>