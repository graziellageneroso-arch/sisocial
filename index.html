<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>SiSocial</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{margin:0;font-family:Arial;background:#111;color:#fff;}
header{
  background:#1e1e1e;
  padding:10px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
header img{
  width:40px;height:40px;border-radius:50%;cursor:pointer;
}
.menu{
  position:absolute;right:10px;top:60px;
  background:#2a2a2a;border-radius:8px;
  display:none;min-width:200px;
}
.menu button{
  background:none;border:none;color:#fff;
  width:100%;padding:10px;text-align:left;
}
.box{padding:15px;}
textarea,input,button{
  width:100%;padding:10px;margin:6px 0;
  border:none;border-radius:6px;
}
button{background:#4caf50;color:#fff;font-weight:bold;}
.post{
  background:#1e1e1e;padding:10px;border-radius:8px;margin-bottom:10px;
}
.actions span{margin-right:15px;cursor:pointer;}
.hidden{display:none;}
.userItem{padding:8px;border-bottom:1px solid #444;cursor:pointer;}
</style>
</head>

<body>

<header class="hidden" id="topo">
  <div>SiSocial</div>
  <img id="fotoTopo" onclick="toggleMenu()">
</header>

<div class="menu" id="menu">
  <button id="userAtual"></button>
  <button onclick="verMeusPosts()">üìå Ver meus posts</button>
  <button onclick="abrirUsuarios()">üë• Tela de usu√°rios</button>
  <hr>
  <button onclick="logout()">üö™ Sair</button>
</div>

<div class="box" id="loginBox">
  <h3>Entrar</h3>
  <input id="codigoLogin" placeholder="C√≥digo de 4 d√≠gitos" maxlength="4">
  <button onclick="login()">Entrar</button>
</div>

<div class="box hidden" id="novoUsuarioBox">
  <h3>Criar novo usu√°rio</h3>
  <input id="nome">
  <input id="codigo" maxlength="4">
  <input type="file" id="foto">
  <button onclick="criarUsuario()">Criar</button>
</div>

<div class="box hidden" id="usuariosBox">
  <h3>Usu√°rios</h3>
  <div id="listaUsuarios"></div>
  <button onclick="abrirNovoUsuario()">‚ûï Criar novo usu√°rio</button>
</div>

<div class="box hidden" id="app">
  <textarea id="textoPost" placeholder="O que voc√™ est√° pensando?"></textarea>
  <button onclick="postar()">Postar</button>
  <div id="feed"></div>
</div>

<script>
let usuarios = JSON.parse(localStorage.getItem("usuarios")) || [];
let posts = JSON.parse(localStorage.getItem("posts")) || [];
let usuarioAtivo = JSON.parse(localStorage.getItem("usuarioAtivo"));
let modoMeusPosts = false;

if(usuarioAtivo) iniciarApp();

function login(){
  const u = usuarios.find(u=>u.codigo===codigoLogin.value);
  if(!u) return alert("Usu√°rio n√£o encontrado");
  usuarioAtivo=u;
  localStorage.setItem("usuarioAtivo",JSON.stringify(u));
  iniciarApp();
}

function criarUsuario(){
  const reader=new FileReader();
  reader.onload=()=>{
    const novo={nome:nome.value,codigo:codigo.value,foto:reader.result};
    usuarios.push(novo);
    localStorage.setItem("usuarios",JSON.stringify(usuarios));
    usuarioAtivo=novo;
    localStorage.setItem("usuarioAtivo",JSON.stringify(novo));
    iniciarApp();
  };
  reader.readAsDataURL(foto.files[0]);
}

function iniciarApp(){
  loginBox.classList.add("hidden");
  novoUsuarioBox.classList.add("hidden");
  usuariosBox.classList.add("hidden");
  app.classList.remove("hidden");
  topo.classList.remove("hidden");
  fotoTopo.src=usuarioAtivo.foto;
  userAtual.innerText="üë§ "+usuarioAtivo.nome;
  renderFeed();
}

function postar(){
  if(!textoPost.value.trim())return;
  posts.unshift({
    autor:usuarioAtivo.nome,
    codigo:usuarioAtivo.codigo,
    texto:textoPost.value,
    likes:0
  });
  localStorage.setItem("posts",JSON.stringify(posts));
  textoPost.value="";
  renderFeed();
}

function renderFeed(){
  feed.innerHTML="";
  posts.filter(p=>!modoMeusPosts||p.codigo===usuarioAtivo.codigo)
  .forEach((p,i)=>{
    feed.innerHTML+=`
      <div class="post">
        <b>${p.autor}</b>
        <p>${p.texto}</p>
        <div class="actions">
          <span onclick="like(${i})">‚ù§Ô∏è ${p.likes}</span>
        </div>
      </div>`;
  });
}

function like(i){
  posts[i].likes++;
  localStorage.setItem("posts",JSON.stringify(posts));
  renderFeed();
}

function verMeusPosts(){
  modoMeusPosts=true;
  renderFeed();
}

function abrirUsuarios(){
  app.classList.add("hidden");
  usuariosBox.classList.remove("hidden");
  listaUsuarios.innerHTML="";
  usuarios.forEach(u=>{
    listaUsuarios.innerHTML+=`
      <div class="userItem" onclick="trocarUsuario('${u.codigo}')">
        ${u.nome}
      </div>`;
  });
}

function trocarUsuario(c){
  usuarioAtivo=usuarios.find(u=>u.codigo===c);
  localStorage.setItem("usuarioAtivo",JSON.stringify(usuarioAtivo));
  iniciarApp();
}

function abrirNovoUsuario(){
  usuariosBox.classList.add("hidden");
  novoUsuarioBox.classList.remove("hidden");
}

function logout(){
  localStorage.removeItem("usuarioAtivo");
  location.reload();
}

function toggleMenu(){
  menu.style.display=menu.style.display==="block"?"none":"block";
}
</script>

</body>
</html>